<div class="users-management">
  <div class="users-container">
    <h1 class="users-title">Users Management</h1>
    
    <div class="users-card">
      <div class="users-header">
        <h2 class="users-subtitle">All Users</h2>
        <div class="users-count">Total: {{ users.length }} users</div>
      </div>
      
      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading users...</p>
      </div>
      
      <!-- Users Table -->
      <div *ngIf="!isLoading" class="table-container">
        <table class="users-table">
          <thead class="table-header">
            <tr>
              <th class="table-header-cell">Image</th>
              <th class="table-header-cell">Name</th>
              <th class="table-header-cell">Email</th>
              <th class="table-header-cell">Phone</th>
              <th class="table-header-cell">Role</th>
              <th class="table-header-cell">Status</th>
              <th class="table-header-cell">Joined</th>
              <th class="table-header-cell">Actions</th>
            </tr>
          </thead>
          <tbody class="table-body">
            <tr *ngFor="let user of users" class="table-row">
              <td class="table-cell user-image-cell">
                <img *ngIf="user.profileImageUrl" [src]="user.profileImageUrl" alt="User Image" class="user-avatar" />
                <div *ngIf="!user.profileImageUrl" class="user-avatar placeholder">
                  <i class="fas fa-user"></i>
                </div>
              </td>
              <td class="table-cell">{{ user.name }}</td>
              <td class="table-cell">{{ user.email }}</td>
              <td class="table-cell">{{ user.phone || 'Not provided' }}</td>
              <td class="table-cell">
                <span class="role-badge role-{{ user.role.toLowerCase() }}">
                  {{ getRoleDisplayName(user.role) }}
                </span>
              </td>
              <td class="table-cell">
                <span class="status-badge" [ngClass]="user.isActive ? 'status-active' : 'status-inactive'">
                  {{ getStatusDisplayName(user.isActive) }}
                </span>
              </td>
              <td class="table-cell">{{ getFormattedDate(user.createdAt) }}</td>
              <td class="table-cell actions-cell">
                <div class="action-buttons">
                  <!-- Role Update Dropdown -->
                  <select 
                    #roleSelect
                    class="role-select"
                    (change)="updateUserRole(user.id, roleSelect.value)"
                    [disabled]="processingUserId === user.id"
                  >
                    <option [value]="user.role" selected>{{ getRoleDisplayName(user.role) }}</option>
                    <option *ngFor="let role of getRoleOptions(user.role)" [value]="role">
                      {{ getRoleDisplayName(role) }}
                    </option>
                  </select>
                  
                  <!-- Toggle Status Button -->
                  <button 
                    class="toggle-status-btn" 
                    [ngClass]="user.isActive ? 'deactivate-btn' : 'activate-btn'"
                    (click)="toggleUserStatus(user.id, user.isActive)"
                    [disabled]="processingUserId === user.id"
                  >
                    <svg *ngIf="user.isActive" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="15" y1="9" x2="9" y2="15"/>
                      <line x1="9" y1="9" x2="15" y2="15"/>
                    </svg>
                    <svg *ngIf="!user.isActive" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <polyline points="20,6 9,17 4,12"/>
                    </svg>
                    {{ processingUserId === user.id ? 'Processing...' : (user.isActive ? 'Deactivate' : 'Activate') }}
                  </button>
                  
                  <!-- Delete Button -->
                  <button 
                    class="delete-btn" 
                    (click)="deleteUser(user.id, user.name)"
                    [disabled]="processingUserId === user.id"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <polyline points="3,6 5,6 21,6"/>
                      <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/>
                    </svg>
                    {{ processingUserId === user.id ? 'Processing...' : 'Delete' }}
                  </button>
                </div>
              </td>
            </tr>
            
            <!-- Empty State -->
            <tr *ngIf="users.length === 0">
              <td colspan="8" class="empty-message">
                No users found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div> 